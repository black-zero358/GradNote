# GradNote - é”™é¢˜çŸ¥è¯†ç‚¹ç®¡ç†ç³»ç»Ÿ

<div align="center">
  <img src="https://s2.loli.net/2025/04/09/ETjvxPNdeqMQLgZ.png" alt="GradNote Logo" style="display:none;">

  ![GitHub](https://img.shields.io/github/license/black-zero358/GradNote)
  ![Python](https://img.shields.io/badge/python-3.13-blue.svg)
  ![FastAPI](https://img.shields.io/badge/FastAPI-0.115.11+-green.svg)
  ![PostgreSQL](https://img.shields.io/badge/PostgreSQL-17.4-blue.svg)
</div>

## ğŸ“š é¡¹ç›®æ¦‚è¿°

GradNoteæ˜¯ä¸€ä¸ªåŸºäºFastAPIå’Œå¤§å‹è¯­è¨€æ¨¡å‹(LLM)çš„é”™é¢˜çŸ¥è¯†ç‚¹ç®¡ç†ç³»ç»Ÿï¼Œå¸®åŠ©å­¦ç”Ÿå’Œæ•™å¸ˆé«˜æ•ˆç®¡ç†ã€åˆ†æå’Œåˆ©ç”¨é”™é¢˜èµ„æºã€‚ç³»ç»Ÿè‡ªåŠ¨ä»é”™é¢˜ä¸­æå–çŸ¥è¯†ç‚¹ï¼Œæ„å»ºçŸ¥è¯†å›¾è°±ï¼Œå¹¶æä¾›æ™ºèƒ½åŒ–çš„å­¦ä¹ å»ºè®®ã€‚

### ğŸ¯ æ ¸å¿ƒç›®æ ‡

- ğŸ” **æ™ºèƒ½é”™é¢˜åˆ†æ**ï¼šåˆ©ç”¨LLMè‡ªåŠ¨åˆ†æé”™é¢˜å¹¶æå–å…³é”®çŸ¥è¯†ç‚¹
- ğŸ§  **çŸ¥è¯†ç‚¹ç½‘ç»œæ„å»º**ï¼šå½¢æˆç»“æ„åŒ–çŸ¥è¯†ä½“ç³»ï¼Œæ­ç¤ºçŸ¥è¯†ç‚¹é—´å…³è”
- ğŸ“Š **å­¦ä¹ å¼±ç‚¹è¯†åˆ«**ï¼šæ£€æµ‹å­¦ä¹ ä¸­çš„è–„å¼±ç¯èŠ‚ï¼Œæä¾›é’ˆå¯¹æ€§å»ºè®®
- ğŸ“ˆ **å­¦ä¹ è¿›åº¦è¿½è¸ª**ï¼šç›‘æ§å­¦ä¹ è¿›åº¦ï¼Œå®ç°ä¸ªæ€§åŒ–å­¦ä¹ 

## âœ¨ åŠŸèƒ½ç‰¹ç‚¹

- **é”™é¢˜ç®¡ç†**
  - æ”¯æŒå¤šç§æ ¼å¼é”™é¢˜å½•å…¥ï¼ˆæ–‡æœ¬ã€å›¾ç‰‡ï¼‰
  - æ™ºèƒ½åˆ†ç±»ä¸æ ‡ç­¾ç³»ç»Ÿ
  - å…¨æ–‡æ£€ç´¢åŠŸèƒ½

- **çŸ¥è¯†ç‚¹æå–**
  - åŸºäºLangChainçš„çŸ¥è¯†ç‚¹è‡ªåŠ¨æå–
  - çŸ¥è¯†ç‚¹å…³è”æ€§åˆ†æ
  - çŸ¥è¯†ä½“ç³»å¯è§†åŒ–

- **å­¦ä¹ è¾…åŠ©**
  - ä¸ªæ€§åŒ–å¤ä¹ è®¡åˆ’ç”Ÿæˆ
  - éš¾ç‚¹æ”»å…‹å»ºè®®
  - å­¦ä¹ èµ„æºæ™ºèƒ½æ¨è

- **ç³»ç»Ÿç›‘æ§**
  - LangFuseæä¾›çš„LLMæ€§èƒ½ç›‘æ§
  - ç”¨æˆ·è¡Œä¸ºåˆ†æ
  - ç³»ç»Ÿä½¿ç”¨ç»Ÿè®¡

## ğŸ› ï¸ æŠ€æœ¯æ¶æ„

### æ ¸å¿ƒæŠ€æœ¯æ ˆ

- **åç«¯æ¡†æ¶**ï¼š[FastAPI](https://fastapi.tiangolo.com/) - é«˜æ€§èƒ½å¼‚æ­¥APIæ¡†æ¶
- **æ•°æ®åº“**ï¼š[PostgreSQL](https://www.postgresql.org/) - å¼€æºå…³ç³»å‹æ•°æ®åº“
- **LLMé›†æˆ**ï¼š
  - [LangChain](https://python.langchain.com/) - LLMåº”ç”¨å¼€å‘æ¡†æ¶
  - [LangGraph](https://python.langchain.com/docs/langgraph) - åŸºäºLangChainçš„æ™ºèƒ½æµç¨‹ç¼–æ’
- **ç›‘æ§åˆ†æ**ï¼š[LangFuse](https://langfuse.com/) - LLMåº”ç”¨ç›‘æ§å¹³å°

### ç³»ç»Ÿæ¶æ„å›¾

```
GradNote
â”‚
â”œâ”€â”€ backend/                 # åç«¯æœåŠ¡
â”‚   â”œâ”€â”€ app/                 # åº”ç”¨ä¸»ç›®å½•
â”‚   â”‚   â”œâ”€â”€ api/             # APIè·¯ç”±æ¨¡å—
â”‚   â”‚   â”‚   â”œâ”€â”€ v1/          # API v1ç‰ˆæœ¬
â”‚   â”‚   â”‚   â””â”€â”€ deps.py      # APIä¾èµ–é¡¹
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ core/            # æ ¸å¿ƒé…ç½®
â”‚   â”‚   â”‚   â”œâ”€â”€ config.py    # é…ç½®ç®¡ç†
â”‚   â”‚   â”‚   â””â”€â”€ security.py  # å®‰å…¨é…ç½®
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ db/              # æ•°æ®åº“æ¨¡å—
â”‚   â”‚   â”‚   â”œâ”€â”€ base.py      # æ•°æ®åº“åŸºç±»
â”‚   â”‚   â”‚   â””â”€â”€ session.py   # ä¼šè¯ç®¡ç†
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ llm_services/    # LLMæœåŠ¡
â”‚   â”‚   â”‚   â”œâ”€â”€ chains/      # LangChainé“¾
â”‚   â”‚   â”‚   â”œâ”€â”€ graphs/      # LangGraphå›¾
â”‚   â”‚   â”‚   â”œâ”€â”€ prompts/     # æç¤ºæ¨¡æ¿
â”‚   â”‚   â”‚   â””â”€â”€ monitoring/  # LangFuseç›‘æ§
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ models/          # æ•°æ®æ¨¡å‹
â”‚   â”‚   â”‚   â”œâ”€â”€ domain/      # é¢†åŸŸæ¨¡å‹
â”‚   â”‚   â”‚   â””â”€â”€ schemas/     # Pydanticæ¨¡å¼
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ services/        # ä¸šåŠ¡æœåŠ¡
â”‚   â”‚   â”‚   â”œâ”€â”€ problem_service.py    # é”™é¢˜æœåŠ¡
â”‚   â”‚   â”‚   â””â”€â”€ knowledge_service.py  # çŸ¥è¯†ç‚¹æœåŠ¡
â”‚   â”‚   â”‚
â”‚   â”‚   â””â”€â”€ main.py          # åº”ç”¨å…¥å£
â”‚   â”‚
â”‚   â”œâ”€â”€ requirements.txt     # ä¾èµ–
â”‚   â”œâ”€â”€ uploads/             # ä¸Šä¼ çš„å›¾ç‰‡
â”‚   â””â”€â”€ .env.example         # ç¯å¢ƒå˜é‡ç¤ºä¾‹
â”‚
â””â”€â”€ README.md                # é¡¹ç›®è¯´æ˜
```

## ğŸš€ å¿«é€Ÿå¼€å§‹

### å‰ææ¡ä»¶

- Python 3.13+
- PostgreSQL 17+
- OpenAI APIå¯†é’¥ï¼ˆæˆ–å…¶ä»–å…¼å®¹LLMçš„APIï¼‰

### å®‰è£…æ­¥éª¤

1. **å…‹éš†ä»“åº“**

```bash
git clone https://github.com/black-zero358/GradNote.git
cd GradNote
```

2. **è®¾ç½®Pythonè™šæ‹Ÿç¯å¢ƒ**

```bash
python -m venv venv
# Windows
venv\Scripts\activate
# Linux/MacOS
source venv/bin/activate
```

3. **å®‰è£…ä¾èµ–**

```bash
pip install -r backend/requirements.txt
```

4. **é…ç½®ç¯å¢ƒå˜é‡**

```bash
cp .env.example .env
# ç¼–è¾‘.envæ–‡ä»¶ï¼Œé…ç½®å¿…è¦å‚æ•°
```

5. **åˆå§‹åŒ–æ•°æ®åº“**

todo...

6. **å¯åŠ¨åº”ç”¨**

```bash
uvicorn app.main:app --reload
```

åº”ç”¨å°†åœ¨ http://localhost:8000 è¿è¡Œ

## ğŸ“š APIæ–‡æ¡£

å¯åŠ¨åº”ç”¨åï¼Œè®¿é—®ä»¥ä¸‹åœ°å€æŸ¥çœ‹APIæ–‡æ¡£:

- **Swagger UI**: http://localhost:8000/docs
- **ReDoc**: http://localhost:8000/redoc

## ğŸ’¡ ä½¿ç”¨æŒ‡å—

### é”™é¢˜ç®¡ç†

#### åˆ›å»ºæ–°é”™é¢˜

```python
import requests

response = requests.post(
    "http://localhost:8000/api/v1/problems/",
    json={
        "title": "æ±‚è§£æ–¹ç¨‹ 2x + 3 = 7",
        "content": "æ±‚è§£æ–¹ç¨‹ 2x + 3 = 7ï¼Œå…¶ä¸­xä¸ºæœªçŸ¥æ•°",
        "subject": "æ•°å­¦",
        "difficulty": "ç®€å•"
    }
)
print(response.json())
```

#### æŸ¥è¯¢é”™é¢˜

```python
response = requests.get(
    "http://localhost:8000/api/v1/problems/",
    params={"subject": "æ•°å­¦", "limit": 10}
)
print(response.json())
```

### çŸ¥è¯†ç‚¹æ“ä½œ

#### æå–çŸ¥è¯†ç‚¹

```python
response = requests.post(
    "http://localhost:8000/api/v1/knowledge/extract",
    json={"problem_id": 1}
)
print(response.json())
```

## ğŸ”§ å¼€å‘æŒ‡å—

### é¡¹ç›®ç»“æ„

- **APIè·¯ç”±** (`app/api/`): å¤„ç†HTTPè¯·æ±‚çš„è·¯ç”±å®šä¹‰
- **æ•°æ®æ¨¡å‹** (`app/models/`): SQLAlchemyå’ŒPydanticæ¨¡å‹
- **ä¸šåŠ¡æœåŠ¡** (`app/services/`): æ ¸å¿ƒä¸šåŠ¡é€»è¾‘
- **LLMæœåŠ¡** (`app/llm_services/`): LLMç›¸å…³åŠŸèƒ½å®ç°

### LLMé“¾è®¾è®¡

æˆ‘ä»¬ä½¿ç”¨LangChainå’ŒLangGraphæ„å»ºLLMåº”ç”¨ï¼Œè®¾è®¡åŸåˆ™:

1. **æ¨¡å—åŒ–**: æ¯ä¸ªé“¾å’Œå›¾éƒ½æœ‰æ˜ç¡®çš„å•ä¸€èŒè´£
2. **å¯é…ç½®**: é€šè¿‡ç¯å¢ƒå˜é‡å’Œé…ç½®æ–‡ä»¶çµæ´»é…ç½®
3. **å¯ç›‘æ§**: é›†æˆLangFuseå®ç°å…¨é“¾è·¯ç›‘æ§
4. **å¯æ‰©å±•**: æ”¯æŒå¤šç§LLMåç«¯

ç¤ºä¾‹LangChainé“¾:

```python
from langchain.chains import LLMChain
from langchain.prompts import PromptTemplate
from langchain_openai import ChatOpenAI

# çŸ¥è¯†ç‚¹æå–é“¾
knowledge_template = """
è¯·ä»ä»¥ä¸‹é¢˜ç›®ä¸­æå–å…³é”®çŸ¥è¯†ç‚¹:
é¢˜ç›®: {problem_content}
è¾“å‡ºæ ¼å¼: ä»¥JSONæ•°ç»„å½¢å¼è¿”å›æå–çš„çŸ¥è¯†ç‚¹
"""

prompt = PromptTemplate(
    input_variables=["problem_content"],
    template=knowledge_template
)

llm = ChatOpenAI(temperature=0)
knowledge_chain = LLMChain(llm=llm, prompt=prompt)
```

### æ•°æ®åº“è®¾è®¡

ä¸»è¦å®ä½“å…³ç³»:

- **Problem**: é”™é¢˜ä¿¡æ¯
- **KnowledgePoint**: çŸ¥è¯†ç‚¹
- **ProblemKnowledge**: é”™é¢˜ä¸çŸ¥è¯†ç‚¹çš„å¤šå¯¹å¤šå…³ç³»
- **User**: ç”¨æˆ·ä¿¡æ¯
- **UserProblemRecord**: ç”¨æˆ·é”™é¢˜è®°å½•

## ğŸ“Š ç›‘æ§ä¸æ€§èƒ½

æˆ‘ä»¬ä½¿ç”¨LangFuseè¿›è¡ŒLLMåº”ç”¨ç›‘æ§:

```python
from langfuse.callback import CallbackHandler

handler = CallbackHandler(
    public_key=os.getenv("LANGFUSE_PUBLIC_KEY"),
    secret_key=os.getenv("LANGFUSE_SECRET_KEY")
)

llm = ChatOpenAI(
    callbacks=[handler]
)
```

## ğŸ¤ è´¡çŒ®æŒ‡å—

1. Forké¡¹ç›®ä»“åº“
2. åˆ›å»ºç‰¹æ€§åˆ†æ”¯ (`git checkout -b feature/amazing-feature`)
3. æäº¤æ›´æ”¹ (`git commit -m 'Add amazing feature'`)
4. æ¨é€åˆ°åˆ†æ”¯ (`git push origin feature/amazing-feature`)
5. åˆ›å»ºPull Request

## ğŸ“ è®¸å¯è¯

æœ¬é¡¹ç›®é‡‡ç”¨AGPL-3.0 license - è¯¦è§ [LICENSE](LICENSE) æ–‡ä»¶


